use inputshare_common::{HidKeyCode, HidModifierKey, HidMouseButton, HidScanCode};
use yawi::{WindowsScanCode, VirtualKey};

pub fn f32_to_i8(v: f32) -> i8 {
     v.round().clamp(i8::MIN as f32, i8::MAX as f32) as i8
}

pub fn vk_to_mod(key: VirtualKey) -> Option<HidModifierKey> {
    match key {
        VirtualKey::LShift   => Some(HidModifierKey::LShift),
        VirtualKey::LControl => Some(HidModifierKey::LCtrl),
        VirtualKey::LWin     => Some(HidModifierKey::LMeta),
        VirtualKey::LMenu    => Some(HidModifierKey::LAlt),
        VirtualKey::RShift   => Some(HidModifierKey::RShift),
        VirtualKey::RControl => Some(HidModifierKey::RCtrl),
        VirtualKey::RWin     => Some(HidModifierKey::RMeta),
        VirtualKey::RMenu    => Some(HidModifierKey::RAlt),
        _                    => None
    }
}

pub fn vk_to_mb(key: VirtualKey) -> Option<HidMouseButton> {
    match key {
        VirtualKey::LButton  => Some(HidMouseButton::LButton),
        VirtualKey::RButton  => Some(HidMouseButton::RButton),
        VirtualKey::MButton  => Some(HidMouseButton::MButton),
        VirtualKey::XButton1 => Some(HidMouseButton::Button4),
        VirtualKey::XButton2 => Some(HidMouseButton::Button5),
        _                    => None
    }
}

pub fn wsc_to_hkc(scancode: WindowsScanCode) -> Option<HidKeyCode> {
     match scancode {
          0x1 => Some(HidKeyCode::Escape),
          0x2 => Some(HidKeyCode::Key1),
          0x3 => Some(HidKeyCode::Key2),
          0x4 => Some(HidKeyCode::Key3),
          0x5 => Some(HidKeyCode::Key4),
          0x6 => Some(HidKeyCode::Key5),
          0x7 => Some(HidKeyCode::Key6),
          0x8 => Some(HidKeyCode::Key7),
          0x9 => Some(HidKeyCode::Key8),
          0xa => Some(HidKeyCode::Key9),
          0xb => Some(HidKeyCode::Key0),
          0xc => Some(HidKeyCode::Minus),
          0xd => Some(HidKeyCode::Equal),
          0xe => Some(HidKeyCode::Backspace),
          0xf => Some(HidKeyCode::Tab),
          0x10 => Some(HidKeyCode::KeyQ),
          0x11 => Some(HidKeyCode::KeyW),
          0x12 => Some(HidKeyCode::KeyE),
          0x13 => Some(HidKeyCode::KeyR),
          0x14 => Some(HidKeyCode::KeyT),
          0x15 => Some(HidKeyCode::KeyY),
          0x16 => Some(HidKeyCode::KeyU),
          0x17 => Some(HidKeyCode::KeyI),
          0x18 => Some(HidKeyCode::KeyO),
          0x19 => Some(HidKeyCode::KeyP),
          0x1a => Some(HidKeyCode::LeftBrace),
          0x1b => Some(HidKeyCode::RightBrace),
          0x1c => Some(HidKeyCode::Enter),
          0x1d => Some(HidKeyCode::LeftCtrl),
          0x1e => Some(HidKeyCode::KeyA),
          0x1f => Some(HidKeyCode::KeyS),
          0x20 => Some(HidKeyCode::KeyD),
          0x21 => Some(HidKeyCode::KeyF),
          0x22 => Some(HidKeyCode::KeyG),
          0x23 => Some(HidKeyCode::KeyH),
          0x24 => Some(HidKeyCode::KeyJ),
          0x25 => Some(HidKeyCode::KeyK),
          0x26 => Some(HidKeyCode::KeyL),
          0x27 => Some(HidKeyCode::Semicolon),
          0x28 => Some(HidKeyCode::Apostrophe),
          0x29 => Some(HidKeyCode::Grave),
          0x2a => Some(HidKeyCode::LeftShift),
          0x2b => Some(HidKeyCode::Backslash),
          0x2c => Some(HidKeyCode::KeyZ),
          0x2d => Some(HidKeyCode::KeyX),
          0x2e => Some(HidKeyCode::KeyC),
          0x2f => Some(HidKeyCode::KeyV),
          0x30 => Some(HidKeyCode::KeyB),
          0x31 => Some(HidKeyCode::KeyN),
          0x32 => Some(HidKeyCode::KeyM),
          0x33 => Some(HidKeyCode::Comma),
          0x34 => Some(HidKeyCode::Dot),
          0x35 => Some(HidKeyCode::Slash),
          0x36 => Some(HidKeyCode::RightShift),
          0x37 => Some(HidKeyCode::KpAsterisk),
          0x38 => Some(HidKeyCode::LeftAlt),
          0x39 => Some(HidKeyCode::Space),
          0x3a => Some(HidKeyCode::Capslock),
          0x3b => Some(HidKeyCode::F1),
          0x3c => Some(HidKeyCode::F2),
          0x3d => Some(HidKeyCode::F3),
          0x3e => Some(HidKeyCode::F4),
          0x3f => Some(HidKeyCode::F5),
          0x40 => Some(HidKeyCode::F6),
          0x41 => Some(HidKeyCode::F7),
          0x42 => Some(HidKeyCode::F8),
          0x43 => Some(HidKeyCode::F9),
          0x44 => Some(HidKeyCode::F10),
          0x45 => Some(HidKeyCode::NumLock),
          0x46 => Some(HidKeyCode::ScrollLock),
          0x47 => Some(HidKeyCode::Kp7),
          0x48 => Some(HidKeyCode::Kp8),
          0x49 => Some(HidKeyCode::Kp9),
          0x4a => Some(HidKeyCode::Kpminus),
          0x4b => Some(HidKeyCode::Kp4),
          0x4c => Some(HidKeyCode::Kp5),
          0x4d => Some(HidKeyCode::Kp6),
          0x4e => Some(HidKeyCode::KpPlus),
          0x4f => Some(HidKeyCode::Kp1),
          0x50 => Some(HidKeyCode::Kp2),
          0x51 => Some(HidKeyCode::Kp3),
          0x52 => Some(HidKeyCode::Kp0),
          0x53 => Some(HidKeyCode::KpDot),
          0x54 => Some(HidKeyCode::Sysrq),
          0x56 => Some(HidKeyCode::Key102ND),
          0x57 => Some(HidKeyCode::F11),
          0x58 => Some(HidKeyCode::F12),
          0x59 => Some(HidKeyCode::KpEqual),
          0x5c => Some(HidKeyCode::Kpjpcomma),
          0x64 => Some(HidKeyCode::F13),
          0x65 => Some(HidKeyCode::F14),
          0x66 => Some(HidKeyCode::F15),
          0x67 => Some(HidKeyCode::F16),
          0x68 => Some(HidKeyCode::F17),
          0x69 => Some(HidKeyCode::F18),
          0x6a => Some(HidKeyCode::F19),
          0x6b => Some(HidKeyCode::F20),
          0x6c => Some(HidKeyCode::F21),
          0x6d => Some(HidKeyCode::F22),
          0x6e => Some(HidKeyCode::F23),
          0x70 => Some(HidKeyCode::Katakanahiragana),
          0x73 => Some(HidKeyCode::Ro),
          0x76 => Some(HidKeyCode::F24),
          0x77 => Some(HidKeyCode::Hiragana),
          0x78 => Some(HidKeyCode::Katakana),
          0x79 => Some(HidKeyCode::Henkan),
          0x7b => Some(HidKeyCode::Muhenkan),
          0x7d => Some(HidKeyCode::Yen),
          0x7e => Some(HidKeyCode::KpComma),
          0xf1 => Some(HidKeyCode::Hanja),
          0xf2 => Some(HidKeyCode::Hangeul),
          0xff => Some(HidKeyCode::ErrOvf),
          0xe010 => Some(HidKeyCode::MediaPreviousSong),
          0xe019 => Some(HidKeyCode::MediaNextSong),
          0xe01c => Some(HidKeyCode::KpEnter),
          0xe01d => Some(HidKeyCode::RightCtrl),
          0xe020 => Some(HidKeyCode::MediaMute),
          0xe021 => Some(HidKeyCode::MediaCalc),
          0xe022 => Some(HidKeyCode::MediaPlayPause),
          0xe024 => Some(HidKeyCode::MediaStopCD),
          0xe02e => Some(HidKeyCode::MediaVolumeDown),
          0xe030 => Some(HidKeyCode::MediaVolumeUp),
          0xe032 => Some(HidKeyCode::MediaWWW),
          0xe035 => Some(HidKeyCode::KpSlash),
          0xe038 => Some(HidKeyCode::RightAlt),
          0xe047 => Some(HidKeyCode::Home),
          0xe048 => Some(HidKeyCode::Up),
          0xe049 => Some(HidKeyCode::PageUp),
          0xe04b => Some(HidKeyCode::Left),
          0xe04d => Some(HidKeyCode::Right),
          0xe04f => Some(HidKeyCode::End),
          0xe050 => Some(HidKeyCode::Down),
          0xe051 => Some(HidKeyCode::PageDown),
          0xe052 => Some(HidKeyCode::Insert),
          0xe053 => Some(HidKeyCode::Delete),
          0xe05b => Some(HidKeyCode::LeftMeta),
          0xe05c => Some(HidKeyCode::RightMeta),
          0xe05d => Some(HidKeyCode::Compose),
          0xe05e => Some(HidKeyCode::Power),
          0xe05f => Some(HidKeyCode::LockingCapsLock),
          0xe063 => Some(HidKeyCode::LockingNumLock),
          0xe065 => Some(HidKeyCode::MediaFind),
          0xe067 => Some(HidKeyCode::MediaRefresh),
          0xe068 => Some(HidKeyCode::MediaStop),
          0xe069 => Some(HidKeyCode::MediaForward),
          0xe06a => Some(HidKeyCode::MediaBack),
          0xe06d => Some(HidKeyCode::MediaEjectCD),
          0xe11d => Some(HidKeyCode::Pause),
          _ => None
     }
}

pub fn wsc_to_hsc(scancode: WindowsScanCode) -> Option<HidScanCode> {
    match scancode {
         0x1 => Some(0x29),
         0x2 => Some(0x1e),
         0x3 => Some(0x1f),
         0x4 => Some(0x20),
         0x5 => Some(0x21),
         0x6 => Some(0x22),
         0x7 => Some(0x23),
         0x8 => Some(0x24),
         0x9 => Some(0x25),
         0xa => Some(0x26),
         0xb => Some(0x27),
         0xc => Some(0x2d),
         0xd => Some(0x2e),
         0xe => Some(0x2a),
         0xf => Some(0x2b),
         0x10 => Some(0x14),
         0x11 => Some(0x1a),
         0x12 => Some(0x8),
         0x13 => Some(0x15),
         0x14 => Some(0x17),
         0x15 => Some(0x1c),
         0x16 => Some(0x18),
         0x17 => Some(0xc),
         0x18 => Some(0x12),
         0x19 => Some(0x13),
         0x1a => Some(0x2f),
         0x1b => Some(0x30),
         0x1c => Some(0x28),
         0x1d => Some(0xe0),
         0x1e => Some(0x4),
         0x1f => Some(0x16),
         0x20 => Some(0x7),
         0x21 => Some(0x9),
         0x22 => Some(0xa),
         0x23 => Some(0xb),
         0x24 => Some(0xd),
         0x25 => Some(0xe),
         0x26 => Some(0xf),
         0x27 => Some(0x33),
         0x28 => Some(0x34),
         0x29 => Some(0x35),
         0x2a => Some(0xe1),
         0x2b => Some(0x31),
         0x2c => Some(0x1d),
         0x2d => Some(0x1b),
         0x2e => Some(0x6),
         0x2f => Some(0x19),
         0x30 => Some(0x5),
         0x31 => Some(0x11),
         0x32 => Some(0x10),
         0x33 => Some(0x36),
         0x34 => Some(0x37),
         0x35 => Some(0x38),
         0x36 => Some(0xe5),
         0x37 => Some(0x55),
         0x38 => Some(0xe2),
         0x39 => Some(0x2c),
         0x3a => Some(0x39),
         0x3b => Some(0x3a),
         0x3c => Some(0x3b),
         0x3d => Some(0x3c),
         0x3e => Some(0x3d),
         0x3f => Some(0x3e),
         0x40 => Some(0x3f),
         0x41 => Some(0x40),
         0x42 => Some(0x41),
         0x43 => Some(0x42),
         0x44 => Some(0x43),
         0x45 => Some(0x53),
         0x46 => Some(0x47),
         0x47 => Some(0x5f),
         0x48 => Some(0x60),
         0x49 => Some(0x61),
         0x4a => Some(0x56),
         0x4b => Some(0x5c),
         0x4c => Some(0x5d),
         0x4d => Some(0x5e),
         0x4e => Some(0x57),
         0x4f => Some(0x59),
         0x50 => Some(0x5a),
         0x51 => Some(0x5b),
         0x52 => Some(0x62),
         0x53 => Some(0x63),
         0x54 => Some(0x46),
         0x56 => Some(0x64),
         0x57 => Some(0x44),
         0x58 => Some(0x45),
         0x59 => Some(0x67),
         0x5c => Some(0x8c),
         0x64 => Some(0x68),
         0x65 => Some(0x69),
         0x66 => Some(0x6a),
         0x67 => Some(0x6b),
         0x68 => Some(0x6c),
         0x69 => Some(0x6d),
         0x6a => Some(0x6e),
         0x6b => Some(0x6f),
         0x6c => Some(0x70),
         0x6d => Some(0x71),
         0x6e => Some(0x72),
         0x70 => Some(0x88),
         0x73 => Some(0x87),
         0x76 => Some(0x73),
         0x77 => Some(0x93),
         0x78 => Some(0x92),
         0x79 => Some(0x8a),
         0x7b => Some(0x8b),
         0x7d => Some(0x89),
         0x7e => Some(0x85),
         0xf1 => Some(0x91),
         0xf2 => Some(0x90),
         0xfc => Some(0x2),
         0xff => Some(0x1),
         0xe010 => Some(0xea),
         0xe019 => Some(0xeb),
         0xe01c => Some(0x58),
         0xe01d => Some(0xe4),
         0xe020 => Some(0xef),
         0xe021 => Some(0xfb),
         0xe022 => Some(0xe8),
         0xe024 => Some(0xe9),
         0xe02e => Some(0xee),
         0xe030 => Some(0xed),
         0xe032 => Some(0xf0),
         0xe035 => Some(0x54),
         0xe038 => Some(0xe6),
         0xe047 => Some(0x4a),
         0xe048 => Some(0x52),
         0xe049 => Some(0x4b),
         0xe04b => Some(0x50),
         0xe04d => Some(0x4f),
         0xe04f => Some(0x4d),
         0xe050 => Some(0x51),
         0xe051 => Some(0x4e),
         0xe052 => Some(0x49),
         0xe053 => Some(0x4c),
         0xe05b => Some(0xe3),
         0xe05c => Some(0xe7),
         0xe05d => Some(0x65),
         0xe05e => Some(0x66),
         0xe05f => Some(0x82),
         0xe063 => Some(0x83),
         0xe065 => Some(0xf4),
         0xe067 => Some(0xfa),
         0xe068 => Some(0xf3),
         0xe069 => Some(0xf2),
         0xe06a => Some(0xf1),
         0xe06d => Some(0xec),
         0xe11d => Some(0x48),
        _ => None
    }
}